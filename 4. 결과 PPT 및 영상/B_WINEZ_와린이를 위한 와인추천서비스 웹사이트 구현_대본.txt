안녕하세요 와린이? 이리와린이, 비와인즈의 이정현a, 최애림 조 발표 시작하겠습니다.



우선 목차는 다음과 같습니다.
기획배경, 문제제기, 목표, 기획, 기대효과, 와인정보 크롤링 및 데이터 전처리, 기능 구현, 보완해야할 점 순입니다.



###########기획배경#####################
먼저 기획배경입니다.
간단하게 와인소비 급증에 대한 플로우를 보여드리자면, 
코로나19 장기화로 인해 주류 문화가 변화하게 되면서, 와인이 대중화가 되었고,
편의점, 대형마트 등 유통 부분에서 변화가 생겼습니다. 
이로 인해, 와인 수입량 및 수입액이 급증하게 되며 와인 수요가 늘게 되었는데요,



코로나는 많은 것을 바꿔놓았지만 특히, 주류 문화 트렌드를 가장 크게 변화시켰습니다.
퇴근후 소주 한잔에서 집에서 와인 한잔을 하는 혼술, 홈술족 문화가 유행하게 되었고,
특히, 20-30대 mz세대 중심으로 취하기 위해 마시는 술에서 '맛있는 술, 즐길 수 있는 술'로 변화하게되었습니다.
또한, 음식에 곁들여 먹는 음주 문화가 확산하면서 와인 시장도 덩달아 성장하고 있는 것으로 보여집니다.



중저가 와인을 대형마트와 편의점에서 쉽게 만나볼 수 있어 접근성이 높아진 점도 한몫하는데요,
저렴한 가격과 다양한 종류로 접근성이 높아지면서, 와인을 찾는 젊은 세대가 늘어나 편의점 '효자 상품'으로 떠오르게 되었습니다.
씨유, 이마트이십사, 쥐에스 세븐일레븐 등 주요 편의점에서 고가의 와인을 판매해도 매진되는 등 와인의 인기에 힘입어
미래의 vip로 여겨지는 와인 입문자 즉, 와린이를 사로 잡을 1만원 이하 가성비 와인 확대에 주력하는 모습을 보여주었습니다.
그 결과, 대부분 전년대비 25프로 가량 와인 매출액이 증가하는 결과를 보여주었습니다.
다음으로 대형마트에서는 1층 입구를 와인 매장으로 조성해 와린이들이 구매하기 쉽게 전문와인숍을 오픈하는 추세라고 합니다.



이러한 와인에 대한 수요로 와인 수입액 및 수입량은 꾸준히 증가 추세를 보이다 20년도에서 21년도 급격한 성장세를 보이게 되었으며
맥주를 제치고 와인이 가장 많이 수입한 주종 1위를 차지하게 되었습니다.
 


이렇게 젊은층까지 와인 소비가 급증하고 있으나, 여전히 와린이 입장에서는 와인숍, 대형마트에서 
와인 고르는 일은 어렵게 느껴지고 있습니다.
따라서 저희 조는 와린이에게 정보 제공 필요성을 느끼며 웹프로젝트로서 와인 사이트에 대한 문제점을 찾아보게 되었습니다.


##############문제제기###########################
먼저 비비노는 가장 대표적인 와인정보 제공 사이트입니다.
앱으로 와인 라벨을 찍으면 관련한 와인정보가 나타나는 것으로 유명한데요,
저희는 사이트의 조회 기능 부분을 중점적으로 확인해보았습니다.
비비노는 레드/화이트/로제 등 와인타입별로, 와인의 원산지 국가/지역별, 포도 품종별, 가격별, 페어링해서 먹을 수 있는 음식별
소비자 리뷰 탑 백 순위를 조회할 수 있는 것으로 나타났습니다.


두번째는 와인나라입니다.
와인나라는 와인 소매업 아영 fbc가 운영하는 와인소매사이트입니다. 정보제공 출처는 vivino였고, 
와인타입, 원산지 국가, 포도 품종별 조회 기능을 제공하고 있었습니다.


세번째는 와인21입니다.
역시 소매 위주 사이트이며, 와인타입별, 원산지 국가별, 가격대별, 페어링할 수 있는 음식, 당도/산도/바디/탄닌 등 
와인 특징별 조회기능을 제공하고 있습니다.
또한, 이달의 와인, 및 와인테마를 선정하여 와인을 추천하는 서비스도 제공하고 있었습니다.



여기서, 저희는 대부분의 와인사이트가 와른이 중점인 부분을 문제점으로 인식했습니다.
와인입문자가 보기에, 원산지 국가, 포도품종, 와인 특징 등은 정확히 알기 어려워 조회 기능 자체에서 1차 선택이 어려워짐을
느낄 수 있습니다. 
또한 한 사이트에서 제공한 추천 서비스 역시, 관여도가 높은 유저 중심으로 이달의 와인을 추천해주고, 
테마별 추천 역시, 고품질 샤르데나 와인의 뛰어난 풍미 등 와린이가 알기 어려운 주제라고 여겨졌습니다.



이처럼 와인 입문자가 활용하기 어려운 용어 및 홈페이지 조회 기능 구성을 가지고 


와인에 배경지식이 없는 와린이도 취향에 맞을 수 있는 와인을 고를 수 있도록, 와인 flavor 즉 맛과 향, 그리고 와인을 마시는 상황별
조회 기능을 제공하고자 합니다.
또한, 도수/바디/당도/산도가 아닌 간단한 은유적 설문 형식을 통해  본인의 와인취향을 유추해 볼 수 있는 추천 시스템 구현과
추가적으로 비비노에서 제공한 와인라벨 인식 시스템을 제공하여 이용자의 편의를 높이는 시스템을 구현할 계획입니다.


##########기획###################################33
기획파트입니다.
먼저 저희 팀은 주피터노트북에서 파이썬 코드를 짜고 파이썬 기반 프레임워크인 장고에 구현하는 식으로 진행했습니다.


랜딩페이지는 다음과 같이 저희의 목표 기능 구현인 나의 와인 취향 알아보기, 카테고리별 와인 추천, 라벨 인식 기능 등
 모두 들어가있습니다.

카테고리 조회 페이지 입니다. 
와인의 맛과 향, 페어링 음식, 와인 특징, 와인을 마시는 상황별로 태그를 제시하여 조회하도록 합니다.


선택된 카테고리는 다음처럼 게시물이 나타나게됩니다.


게시물을 클릭하면 다음과 같이 와인 설명 상세페이지를 확인할 수 있습니다.




###########기대효과#####################

기존 사이트의 고관여도 유저 중심 정보 조회 제공에서
직관적이고 이해하기 쉬운 카테고리별 정보 조회 제공을 통해
1차 장벽인 홈페이지 조회에서 좀 더 정보 와인 입문이 쉬워지게 되면,
와인 수요성장과 같이 와린이들의 와인 입문이 증가하고 최종적으로 와인 및 주류 시장이 성장할 수 있을 것으로 보입니다.






###########3와인정보 데이터 크롤링 및 전처리#####################
다음은 와인정보 데이터 크롤링 및 전처리 과정을 보여드리겠습니다.


와인 정보는 대부분의 사이트에서,
와인이름, 국가, 와이너리, 포도 품종, 도수, 당도/산도/바디, 페어링 음식, 와인 flavor 등이 기재되어 있으며
가장 표준화되어 있고, 국내에서 판매되고 있는 와인을 다수 보유한 신세계 l&b 와인 사이트를 주요 정보를  수집하기로 정했습니다.
2차적으로 신세계에서 크롤링 된 와인이름에 대해 vivino에 검색하여 도수정보를 크롤링하였습니다.



크롤링이 완료된 데이터프레임은 다음과 같습니다.
총 961개 데이터로 컬럼은 15가지 입니다.



저희가 전처리를 통해 생성한 컬럼은 총 2개 입니다. 
와인의 향과 맛이 문장으로 기재되어 있는 와인설명 컬럼에서 flavor 관련 키워드를 추출한 것이 첫번째입니다.
기존에 사전 조사를 통해 와인 flavor종류를 정리해두고, 
와인 설명 컬럼 내 문장들을 okt 클래스 및 counter 함수를 활용해서
향과 관련된 키워드를 찾고 기존 flavor 종류에 추가하여 최종 flavor키워드를 중분류/소분류로 나누어 총 16개의 중분류로된 
데이터프레임을 생성했습니다.
한가지 예시로 중분류 핵과는 소분류 매실, 복숭아, 살구, 앵두를 포함하고 있음을 보실 수 있습니다.



이 flavor 분류 데이터프레임을 기준으로 와인설명 컬럼의 문장에서 키워드를 추출하고 중분류, 소분류를 나누어
다음과 같이 딕셔너리형태로 flavor_dict 컬럼을 생성해두었습니다.
예시를 보여드리자면, 첫 행의 와인설명 컬럼의 살구, 복숭아, 아카시아 키워드를 추출하여 오른쪽과같이 아카시아가 속한 꽃을 키워드로,
북숭아, 살구가 속한 핵과를 키워드로 생성하여 딕셔너리로 저장된 모습을 보실 수 있습니다.





두번째는 페어링 음식 컬럼입니다. 
역시 okt 클래스 및 counter 함수를 활용해 단어별 내림차순 정렬로 소분류 키워드를 정리하고, 이에 따른 중분류 카테고리를 
육류, 해산물, 양식, 매운음식, 중국음식, 에피타이저, 디저트 7개로 나누었습니다.


마찬가지로, 페어링 디쉬 컬럼 내 해당 소분류 키워드가 있는 경우 dish 컬럼을 생성하여 해당 중분류를 기입하도록 전처리해주었습니다.
예시를 보여드리자면, 차가운 육류요리나 가금류, 붉은 육류요리, 치즈로 기재된 페어링디쉬는 육류 및 에피타이저로,
해산물이나 매콤한 요리, 간단한 핑거푸드는 매운음식, 해산물, 디저트로 대분류됨을 보실 수 있습니다.



마지막으로 와이너리설명 컬럼 중 신세계 l&b 픽이라 되어 있는 와인 정보는 삭제하였으며,
도수가 null값으로 되어있는 경우도 삭제해서 최종적으로 325개행으로 구성된 데이터프레임을 생성하였습니다.




기능 구현에 대해 설명드리겠습니다.


첫번째 기능은 와린이의 와인 취향 유추해보기 입니다.
추천을 위해 케이스구분 후 눈과 손을 이용해 자체적으로 군집화하여 분류모델링을 진행했습니다
와인을 선택하는 주요 특징인 타입, 당도, 바디, 산도, 도수를 다음과 같이 범주화하여 해당하는 경우의 수를 모두 추출했고,
총 스물네가지의경우의 수와 그 경우의수에 해당하는 행의 개수를 산출했고, 
케이스 및 개수를 고려하여 비슷한 조건끼리 레이블을 부여했습니다.



원본 데이터프레임에 레이블 분류 컬럼을 생성해주고 범주화되지 않은 자료로 의사결정트리 분류모델에 학습을 시켜주었으며,
피처별 중요도를 확인하였습니다.
보시면 와인타입, 도수, 당도 순으로 주요 분류 기준이 되는 것을 알았으며,


중요피처를 활용해 특징을 잡고 해당 군집의 피처별 unique를 확인해서 군집 레이블명을 지어주었습니다.
첫번째 군집은 도수가 낮고 당도가 높으며, 와인타입이 레드, 화이트로 구성되어 '어린이입맛 술린이'
두번째는 도수가 낮고, 당도가 낮으며, 레드, 화이트로 구성되어 '어른입맛 술린이'
세번째는 도수는 보통이며, 당도는 높고, 레드로 구성되어 어린이입맛 red 술청년 등

도수를 기준으로 낮은경우 술린이, 보통은 술청년, 강함은 술른이,
당도를 기준으로 높으면 어린이입맛, 낮으면 어른 입맛
등으로 기재해 군집화 레이블명을 생성해주었습니다.





이렇게 구분된 군집 내 와인들은 분류모델링을 장고에 구현시켰습니다.
나의 와인 취향 알아보기를 클릭하면,
당도/산도/바디/와인타입/도수를 유추할 수 있는 해당 설문이 간단하게 진행되며, 클릭된 해당값을 수치로 환산하여
분류모델에 적용 후, 분류된 군집에 해당되는 와인을 postlist해주었습니다.
설문을 잠깐 살펴보자면, 
당도를 파악하는 항목은 공차에서 음료수를 시킬 떄 내 음료 당도
산도는 신음료가 마시고싶을 때 내가 주문하는 음료: 딸기 청포도 오렌지 키위 레몬 순으로 선택지가 기재되어있습니다.,
바디는 아메리카노, 샷추가 아메리카노, 라떼, 플랫화이트, 에스프레스 순으로 가벼운맛에서 녹진하고 묵직한 맛 순으로 선택하도록 했습니다.
레드 화이트 스파클링을 유추할수 잇도록 가장 어울리는 대분류 음식 설문항문ㅇ르 제작했습니다.




다음은 상황 카테고리를 위한 군집화 과정입니다.
기존 크롤링 정보에서는 상황에 대한 정보가 없었기 때문에,
저희는 당도/산도 음식 대분류 컬럼을 가지고 군집화를 통해 상황별 카테고리를 생성하기로 했습니다.
군집화를 위해 도수를 제외한 당도, 산도를 0,1로 범주화해주었으며, 음식 대분류가 기입된 dish컬럼은 
더미변수를 생성하여 해당 카테고리가 들어있는 경우 1, 아닌 경우 0으로 원핫인코딩을 진행하였습니다.


다음은 k-means를 활용한 최적 군집 개수를 찾기 위해 이너시아 함수를 활용해보았고 실루엣 계수를 고려해
최종 군집 수를 5개로 선정하였습니다.


다음은 5개의 군집별 도수, 당도, 산도 및 음식 대분류별 평균값입니다.
해석에 유의해야할 점은! 당도는 1과 가까울수록 낮고, 0일수록 높다는 점이고
산도는 1일 수록 높음, 0은 낮음 이라는 점입니다.
0번째 군집은 당도가 낮지만 음식 대분류 수치가 다른 군집과 비교했을 때 중상위권으로 대부분의 음식에 잘어울리는 편입니다.
따라서 뭐든 좋아!라는 특징을 잡고 태그레이블을 가족과 함께라고 정했습니다.

첫번째 군집은 도수는 낮고, 당도는 높고, 디저트 관련 수치가 높아서 극강의 단맛을 좋아하는 달콤한 친구와 함께,

두번째 군집은 도수는 매우 낮고, 당도도 낮고, 육류와 에피타이저 수치가 높아 술보단 코스요리를 좋아하는 술린이 연인과 함께

세번째 군집은 도수는 높고, 당도는 낮고, 육류/양식 수치가 높아 술른이 연인과 함께
네번째는 도수, 당도는 적당하지만 타 군집에 비해 매운 음식 수치가 높아 매운음식을 먹기 위한 화끈한 친구와 함께 태그를 생성해주었습니다.







다음과 같이 군집레이블을 상황 카테고리로 지정하여 선택시 해당 군집 와인을 포스트리스트해주었습니다.


마지막으로 와인 라벨 이미지 내 텍스트를 추출하여 검색하는 기능에 대해 설명드리겠습니다.
먼저 원본 데이터프레임 내에 국문과 영문으로 구성되어 잇는 와인이름 컬럼들을 리스트화하여 표준화된
와인이름 리스트를 제작하고자, for문을 이용해 모든 글자를 추출했고, 
와인이름에 들어있는 특수문자를 추출하여 정규표현식으로 삭제해주었습니다.

그래서 총 세개의 리스트를 생성했습니다.
첫번째는 특수문자를 삭제한 띄어쓰기가 되어있는 이름 리스트 wine_li_delete_stopwords
두번재는 특수문자 및 띄어쓰기를 삭제한 이름 리스트  wine_li_delete_blank
세번째는 와인이름을 구성하는 단어들로 이루어진 wine_str_set 리스트입니다.

내용은 다음과 같습니다.
와인이름이 이기갈 꼬뜨 뒤 론 레드인 국문과 영문으로 이루어져있는 리스트, 
그리고 띄어쓰기를 제거한 리스트,
그리고 이기갈, 꼬드, 뒤, 론 등 단어로 구성된 리스트를 확인해보실 수 있습니다.







이렇게 리스트를 생성한 이후,
pytesseract 라이브러리를 활용하여 이미지 내 텍스트를 추출하였습니다.
먼저 와인 라벨 이미지파일을 업로드시, 파이테서렉트의 image_to_string 함수를 활용해 해당 텍스트를 인식해옵니다.



인식된 텍스트 중 탭, 줄바꿈 특수문자 제외 영어/한국어/숫자만 모두 추출하도록 정규표현식을 사용했습니다.
해당 텍스트 중 앞서 구비해둔 와인이름 단어 리스트에 해당하는 키워드만 따로 추출하여 스트링으로
와인이름을 생성해주었습니다.
그리고 ord 함수로 한국어/영어를 구분해주는 사용자 함수를 생성해주어 해당 와인이름이 영문인지/국문인지 구분해주었습니다.





마지막으로 영문/ 국문으로 구분된 와인이름을 기준으로 한국어면 국문 와인이름을,
영어면 영문 와인이름과 비교하여 difflib라이브러리의 시퀀스매처 함수로 와인이름 일치율을 계산하여 컬럼에 부여해주었습니다.
계산된 일치율을 기준으로 내림차순 정렬 후 해당 순서대로 와인 정보가 postlist되도록 구현했습니다.



다음은 추가 기능인데요,
로그인 후 마이페이지 내에 찜하기 기능을 추가하여 나만의 와인셀러에 원하는 와인정보를 저장할 수 있도록 구현했습니다.


다음은 지금까지 말씀드린 기능에 대해 구현 영상을 보시겠습니다.


해당 기획 및 구현에 있어서 아쉬운 점은 사이트 내 완벽한 정보가 325개 였다는 것입니다.
더 많은 정보 업데이트가 필요할 것으로 보이고, 굴곡진 와인라벨을 인식하지 못하는 경우가 있어 이미지 내 텍스트 인식 기능의 고급화가 필요하다고 느꼈습니다.
또한 추가로 구현하고 싶은 부분은 와인 커뮤니티 공간 생성 및 이벤트/와인관련 꿀팁정보 포스팅 입니다.


지금까지 비와인즈 이정현a, 최애림이었습니다. 감사합니다.




















